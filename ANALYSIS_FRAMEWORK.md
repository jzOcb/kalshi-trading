# Kalshi 市场分析框架

## 架构

```
1. kalshi_pipeline.py → 筛选候选 (极端价格 + 流动性 + Tier)
2. 输出 JSON → ~/clawd/kalshi/data/candidates.json
3. Cron/手动触发 → 发送给 OpenClaw Agent
4. Agent (Opus) → 多角色深度分析 → 输出建议
```

## 多角色分析框架

收到候选市场后，我按以下角色顺序分析：

### 【分析师】初始判断
1. 这个市场本质在问什么？
2. 结算数据源是什么？
3. 我的初步判断是：___
4. 理由：___

### 【事实核查员】验证
1. 分析师提到的数据源正确吗？
2. **历史先例**：这件事发生过吗？
   - 发言类市场 → 搜索历史 transcript/记录
   - 经济数据 → 查历史均值和修正
3. **阈值检验**：市场设的门槛是高是低？
4. 核查结论：分析师的判断 [可靠/存疑/错误]

### 【魔鬼代言人】挑战
1. 分析师可能错在哪里？
2. 什么情况下判断会翻车？
3. 被忽略的风险因素？
4. 反对意见的可信度：[高/中/低]

### 【风控官】最终把关
1. 价格意味着什么赔率？
   - 对了赚多少，错了亏多少
   - 赔率是否有利
2. 综合以上讨论：
   - 分析师可信度
   - 事实核查是否通过
   - 魔鬼代言人反对是否有效
3. 最终建议：[强烈买入/买入/观望/跳过]
4. 核心风险一句话

## 第一性原理检查清单

每个市场必须验证：

- [ ] **结算源**：具体用什么数据？
- [ ] **历史先例**：发生过吗？实际搜索确认
- [ ] **基准线**：阈值对比历史均值
- [ ] **当前数据**：拉实际数字，不是假设
- [ ] **风险收益**：显式计算赔率

## 案例参考

### Powell "Stagflation" (2026-02-22)
- 搜索了 12 份 FOMC transcript
- 结果：0 次提及
- 结论：NO @ 88¢ 高确定性

### Payrolls >20K (2026-02-22)
- 初始假设：20K 门槛很低
- 核查：2025 月均只有 15K (下修后)
- 结论：风险高于预期，88¢ 赔率不值

## URL 格式

给用户链接时用正确格式:

```
https://kalshi.com/markets/{series}/{slug}/{event_ticker}
```

**Slug 映射** (`url_mapping.py`):
- KXCPI → cpi
- KXGDP → us-gdp-growth
- KXPAYROLLS → jobs-numbers
- KXFED → fed-funds-rate

**例子**:
- `https://kalshi.com/markets/kxcpi/cpi/kxcpi-26feb`
- `https://kalshi.com/markets/kxgdp/us-gdp-growth/kxgdp-26apr30`

---

*此框架随案例积累持续更新*
